/**
 * @file: menu.c
 * @author: Honokawings (1915569481@qq.com)
 * @description: 菜单结构建立
 * @version 0.1
 * @date: 2020-10-22 16:10:99
 * 
 * @copyright Copyright (c) 2020
 * 
 */
#include "menu.h"

//从上至下 逆序字符
static u8 code str_menu[][32]=
{
{0x00,0x02,0x02,0xC2,0x02,0x02,0x02,0xFE,0x82,0x82,0x82,0x82,0x82,0x02,0x00,0x00,0x40,0x40,0x40,0x7F,0x40,0x40,0x40,0x7F,
 0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00},/*"正",0*/
{0x02,0xE2,0x22,0x22,0x3E,0x00,0x08,0x88,0x48,0x39,0x0E,0x08,0xC8,0x08,0x08,0x00,0x00,0x43,0x82,0x42,0x3E,0x00,0x21,0x71,
 0x29,0x25,0x23,0x21,0x28,0x70,0x00,0x00},/*"弦",1*/
{0x10,0x60,0x02,0x0C,0xC0,0x00,0xF8,0x88,0x88,0x88,0xFF,0x88,0x88,0xA8,0x18,0x00,0x04,0x04,0x7C,0x03,0x80,0x60,0x1F,0x80,
 0x43,0x2C,0x10,0x28,0x46,0x81,0x80,0x00},/*"波",2*/
{0x80,0x82,0x82,0xFE,0x82,0x82,0xFE,0x82,0x82,0x80,0x20,0x10,0x08,0x86,0x60,0x00,0x80,0x40,0x30,0x0F,0x00,0x00,0xFF,0x00,
 0x00,0x80,0x84,0x42,0x21,0x10,0x0C,0x00},/*"形",3*/


{0x00,0x04,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x84,0x04,0x00,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x00},/*"三",0*/
{0x20,0x10,0xE8,0x24,0x27,0x24,0x24,0xE4,0x24,0x34,0x2C,0x20,0xE0,0x00,0x00,0x00,0x80,0x60,0x1F,0x09,0x09,0x09,0x09,0x7F,
0x09,0x09,0x49,0x89,0x7F,0x00,0x00,0x00},/*"角",1*/
{0x10,0x60,0x02,0x0C,0xC0,0x00,0xF8,0x88,0x88,0x88,0xFF,0x88,0x88,0xA8,0x18,0x00,0x04,0x04,0x7C,0x03,0x80,0x60,0x1F,0x80,
0x43,0x2C,0x10,0x28,0x46,0x81,0x80,0x00},/*"波",2*/
{0x80,0x82,0x82,0xFE,0x82,0x82,0xFE,0x82,0x82,0x80,0x20,0x10,0x08,0x86,0x60,0x00,0x80,0x40,0x30,0x0F,0x00,0x00,0xFF,0x00,
0x00,0x80,0x84,0x42,0x21,0x10,0x0C,0x00},/*"形",3*/

{0x00,0xFE,0x22,0x22,0xFE,0x00,0x40,0x48,0xC8,0x09,0xFA,0xE4,0x40,0x20,0x10,0x00,0x80,0x7F,0x02,0x82,0xFF,0x20,0x10,0x0C,
0x43,0x80,0x7F,0x00,0x07,0x18,0x20,0x00},/*"脉",0*/
{0x00,0x02,0x0C,0xC0,0x00,0xF0,0x10,0x10,0x10,0xFF,0x10,0x10,0x10,0xF0,0x00,0x00,0x02,0x02,0x7F,0x00,0x00,0x0F,0x04,0x04,
0x04,0xFF,0x04,0x04,0x04,0x0F,0x00,0x00},/*"冲",1*/
{0x08,0x08,0x08,0x08,0x08,0xF8,0x89,0x8E,0x88,0x88,0x88,0x88,0x08,0x08,0x08,0x00,0x00,0x80,0x40,0x20,0x18,0x07,0x00,0x00,
0x40,0x80,0x40,0x3F,0x00,0x00,0x00,0x00},/*"方",2*/
{0x10,0x60,0x02,0x0C,0xC0,0x00,0xF8,0x88,0x88,0x88,0xFF,0x88,0x88,0xA8,0x18,0x00,0x04,0x04,0x7C,0x03,0x80,0x60,0x1F,0x80,
0x43,0x2C,0x10,0x28,0x46,0x81,0x80,0x00},/*"波",3*/

{0x00,0x02,0x02,0xC2,0x02,0x02,0x02,0xFE,0x82,0x82,0x82,0x82,0x82,0x02,0x00,0x00,0x40,0x40,0x40,0x7F,0x40,0x40,0x40,0x7F,
0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x00},/*"正",0*/
{0x02,0xE2,0x22,0x22,0x3E,0x00,0x08,0x88,0x48,0x39,0x0E,0x08,0xC8,0x08,0x08,0x00,0x00,0x43,0x82,0x42,0x3E,0x00,0x21,0x71,
0x29,0x25,0x23,0x21,0x28,0x70,0x00,0x00},/*"弦",1*/
{0x00,0xFE,0x22,0x22,0xFE,0x00,0x40,0x48,0xC8,0x09,0xFA,0xE4,0x40,0x20,0x10,0x00,0x80,0x7F,0x02,0x82,0xFF,0x20,0x10,0x0C,
0x43,0x80,0x7F,0x00,0x07,0x18,0x20,0x00},/*"脉",2*/
{0x00,0x02,0x0C,0xC0,0x00,0xF0,0x10,0x10,0x10,0xFF,0x10,0x10,0x10,0xF0,0x00,0x00,0x02,0x02,0x7F,0x00,0x00,0x0F,0x04,0x04,
0x04,0xFF,0x04,0x04,0x04,0x0F,0x00,0x00},/*"冲",3*/
{0x08,0x08,0x08,0x08,0x08,0xF8,0x89,0x8E,0x88,0x88,0x88,0x88,0x08,0x08,0x08,0x00,0x00,0x80,0x40,0x20,0x18,0x07,0x00,0x00,
0x40,0x80,0x40,0x3F,0x00,0x00,0x00,0x00},/*"方",4*/
{0x10,0x60,0x02,0x0C,0xC0,0x00,0xF8,0x88,0x88,0x88,0xFF,0x88,0x88,0xA8,0x18,0x00,0x04,0x04,0x7C,0x03,0x80,0x60,0x1F,0x80,
0x43,0x2C,0x10,0x28,0x46,0x81,0x80,0x00}/*"波",5*/
};

static u8 code str_picture[][24]=
{
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8},
{0xFC,0x0E,0x06,0x66,0x66,0x66,0x66,0x66,0x66,0x67,0xFF,0xF6,0x66,0x66,0x66,0x66,0xE6,0xC6,0x86,0x06,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0C,0x0C,0x0C,0x0C,0x2C,0xEC,0x8C,0x0D,0x0F,0x0E,0x0C},
{0x0C,0x0C,0x88,0xF8,0x78,0x18,0x18,0x18,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x1F,0x00,0x03,0x33,0x33,0x33,0x33,0x33,0x33,0x37,0xFF,0xFF,0x33,0x33,0x36,0x36},
{0x36,0x1F,0x0F,0x06,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0x1C,0x06},
{0x06,0x86,0xC7,0xC7,0xC6,0xE6,0x66,0x66,0x76,0x36,0x37,0x07,0x06,0x06,0x06,0x06,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0xFF,0x00,0x00,0x00,0x7C,0xFE,0x87,0x83,0x83},
{0x83,0x83,0x83,0x83,0x83,0x83,0x83,0x83,0xC6,0xFC,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0xFC,0xFF,0x00,0x00,0x00,0x80,0x81,0xC4,0xCC,0xCC,0x66,0x66,0x66,0x36,0x30,0x38,0x18,0x18,0x0C,0x08},
{0x00,0x00,0x00,0xFF,0x20,0x20,0xFC,0x00,0xF8,0x88,0xF8,0x00,0xF0,0x10,0xE0,0x00,0xE0,0xA0,0xE0,0x00,0xFE,0x20,0x50,0x88},
{0x04,0xF0,0x50,0x50,0xF0,0x00,0x70,0x40,0x60,0x40,0x70,0x06,0x74,0x00,0xF8,0x10,0x70,0x00,0x78,0x48,0xF8,0x00,0x7C,0x44},
{0xCC,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0xC0,0xC0,0xC0,0xC0,0xC0,0x80,0x00,0x01,0x01},
{0x00,0x00,0x00,0x80,0xC0,0xC1,0xC1,0xC1,0xC1,0x81,0x01,0x01,0x01,0x01,0xC1,0xC1,0xC1,0xC0,0x80,0x00,0x00,0x00,0x00,0x00},
{0x00,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0xC0,0x80,0x80,0x00,0x00,0x01,0xC1,0xC0,0xC0,0xC0,0x81,0x01,0x00,0x00,0x00,0x00,0x00},
{0x00,0xC0,0xC0,0xC0,0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x07,0x00,0x80,0xC1,0xC0,0xC0,0xC0,0xC0,0x80,0x01,0x00,0x00,0x00},
{0x00,0x00,0x80,0xC0,0xC3,0xC0,0xC0,0xC0,0x81,0x00,0x00,0x00,0x00,0x00,0x80,0xC0,0xC0,0xC0,0xC0,0x80,0x80,0x00,0x00,0x00},
{0x01,0x01,0x81,0xC1,0xC1,0xC0,0xC6,0xC4,0x87,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1C,0x1F,0x03,0x01},
{0x00,0x00,0x00,0x81,0xE3,0x7F,0x1C,0x00,0x00,0xFC,0xFF,0x03,0x01,0x00,0x00,0x00,0x01,0x03,0xFF,0xFC,0x00,0x00,0x00,0x00},
{0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC1,0xF3,0x3F,0x00,0x00,0x00,0x00,0x00},
{0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x1C,0x1F,0x03,0x01,0x00},
{0x00,0x00,0x81,0xE3,0x7F,0x1C,0x00,0x00,0xFC,0xFF,0x03,0x01,0x00,0x00,0x00,0x01,0x03,0xFF,0xFC,0x00,0x7E,0xFF,0x81,0x00},
{0x00,0x00,0x00,0x01,0x03,0xFF,0x00,0x00,0xFC,0xFF,0x03,0x01,0x00,0x00,0x00,0x01,0x03,0xFF,0xFC,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0xE0,0xF0,0x38,0x1C,0x0C,0x06,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x3F,0xFF,0xC0,0x80,0x00,0x00,0x00},
{0x80,0xC0,0xFF,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0xF0,0x7C,0x0F},
{0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00},
{0x00,0x00,0x00,0xE0,0xF0,0x38,0x1C,0x0C,0x06,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x3F,0xFF,0xC0,0x80,0x00,0x00,0x00,0x80},
{0xC0,0xFF,0x3F,0x00,0x80,0x80,0x01,0x03,0x03,0x03,0x03,0x83,0xE3,0x7F,0x00,0x00,0x3F,0xFF,0xC0,0x80,0x00,0x00,0x00,0x80},
{0xC0,0xFF,0x3F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x00},
{0x00,0x00,0x00,0x01,0x03,0x03,0x03,0x03,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x02,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x00,0x00,0x00,0x00,0x00},
{0x00,0x00,0x00,0x00,0x00,0x01,0x03,0x00,0x00,0x00,0x00,0x01,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x00,0x00},
{0x00,0x00,0x01,0x03,0x03,0x03,0x03,0x03,0x01,0x00,0x00,0x00,0x01,0x01,0x03,0x03,0x03,0x03,0x03,0x01,0x00,0x00,0x00,0x00},
{0x00,0x00,0x01,0x03,0x03,0x03,0x03,0x03,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00},/*"E:\Pictures\12864\12864定制页面.bmp",0*/
};

//正弦参数 128点 7精度
static u8 code sin_dot[128]=
{0x3F,0x42,0x45,0x48,0x4B,0x4E,0x51,0x54,0x57,0x5A,0x5D,0x60,0x62,0x65,0x67,0x6A
,0x6C,0x6E,0x70,0x72,0x74,0x75,0x77,0x78,0x7A,0x7B,0x7C,0x7D,0x7D,0x7E,0x7E,0x7E
,0x7E,0x7E,0x7E,0x7E,0x7D,0x7D,0x7C,0x7B,0x7A,0x78,0x77,0x75,0x74,0x72,0x70,0x6E
,0x6C,0x6A,0x67,0x65,0x62,0x60,0x5D,0x5A,0x57,0x54,0x51,0x4E,0x4B,0x48,0x45,0x42
,0x3F,0x3C,0x39,0x36,0x33,0x30,0x2D,0x2A,0x27,0x24,0x21,0x1E,0x1C,0x19,0x17,0x14
,0x12,0x10,0x0E,0x0C,0x0A,0x09,0x07,0x06,0x04,0x03,0x02,0x01,0x01,0x00,0x00,0x00
,0x00,0x00,0x00,0x00,0x01,0x01,0x02,0x03,0x04,0x06,0x07,0x09,0x0A,0x0C,0x0E,0x10
,0x12,0x14,0x17,0x19,0x1C,0x1E,0x21,0x24,0x27,0x2A,0x2D,0x30,0x33,0x36,0x39,0x3C};

void menu0()
{

    show_screen(str_picture[0],0);
    // show_sentence(1,str_menu[0],4,0);
    // show_sentence(2,str_menu[4],4,0);
    // show_sentence(3,str_menu[8],4,0);
    // show_sentence(4,str_menu[12],6,0);
}

void menu1()
{
    clear(0);
    show_sentence(1,str_menu[0],4,1);
    show_sentence(2,str_menu[4],4,0);
    show_sentence(3,str_menu[8],4,0);
    show_sentence(4,str_menu[12],6,0);
}

void menu2()
{
    clear(0);
    show_sentence(1,str_menu[0],4,0);
    show_sentence(2,str_menu[4],4,1);
    show_sentence(3,str_menu[8],4,0);
    show_sentence(4,str_menu[12],6,0);
}

void menu3()
{
    clear(0);
    show_sentence(1,str_menu[0],4,0);
    show_sentence(2,str_menu[4],4,0);
    show_sentence(3,str_menu[8],4,1);
    show_sentence(4,str_menu[12],6,0);
}

void menu4()
{
    clear(0);
    show_sentence(1,str_menu[0],4,0);
    show_sentence(2,str_menu[4],4,0);
    show_sentence(3,str_menu[8],4,0);
    show_sentence(4,str_menu[12],6,1);
}

void menu5()//实时渲染波形-正弦
{
    u8 x,y;
    clear(0);
    for(x=0;x<128;x++)
    {
        y=127-sin_dot[x]/2;
        draw_dot(x,y);
    }
}

void menu6()//实时渲染波形-三角
{
    u8 x,y;
    clear(0);
    for(x=0;x<32;x++)
    {
        y=32-x;
        draw_dot(x,y);
    }
    for(x=32;x<64;x++)
    {
        y=32-x;
        draw_dot(x,y);
    }
    for(x=64;x<96;x++)
    {
        y=x-32;
        draw_dot(x,y);
    }
    for(x=96;x<128;x++)
    {
        y=160-x;
        draw_dot(x,y);
    }
}

//手动构建菜单
// u8 index;
// u8 move_up;
// u8 move_down;
// u8 move_enter;
// u8 move_esc;
//记得更改菜单项总数 此处和main处
MenuIndex code menu_gather[7]=
{
    {0,0,0,1,0,(*menu0)},
    {1,4,2,5,0,(*menu1)},
    {2,1,3,6,0,(*menu2)},
    {3,2,4,3,0,(*menu3)},
    {4,3,1,4,0,(*menu4)},
    {5,5,5,5,1,(*menu5)},
    {6,6,6,6,2,(*menu6)}
};

//注释部分为待拓展结构，慎删除
//C51构建树形结构不好处理内存分配问题
// /**
//  * @description: 创建新的同级下一节点
//  * 
//  * @param: head 此级菜单的头节点
//  * @param: function 新节点功能
//  * @param: name 新节点名称
//  * @return: menu_t* 返回创建的节点
//  */
// menu_t *add_same_node(menu_t *head ,void *function,u8 function_id , u8 *name )
// {
//     menu_t *p=NULL,*pr=head;
//     p=(menu_t *)malloc(sizeof(menu_t));//创建空节点

//     if(head==NULL)  //头节点为空，则创建头节点
//     {
//         head=p;
//         p->id=0;         
//     }
//     else    //头节点不为空
//     {
//         u8 i=0;
//         while (pr->same_down!=NULL) //寻找并转到同级菜单的最后节点
//         {
//             i++;
//             pr=pr->same_down;
//         }
//         pr->same_down=p;//创建同级节点
//         p->same_up=pr;
//         p->father=head->father;//和头节点拥有同样的父节点
//         p->id=i;
//     }
//     p->function=function;//补充新节点的信息
//     p->function_id=function_id;
//     p->menu_name=name;
//     p->son=NULL;
//     p->same_down=NULL;
//     return p;//返回新建的节点
// }

// /**
//  * @description: 创建子节点
//  * 
//  * @param: head 当前列表头节点
//  * @param: num 列表要创建子节点的节点编号
//  * @param: function 节点函数功能
//  * @param: name 节点名称
//  * @return: menu_t* 返回该位置的子节点或者新节点
//  */
// menu_t *add_son_node(menu_t *head, u8 num, void *function,u8 function_id ,u8 *name )
// {
//     u8 i;
//     menu_t *pr=head;
    
//     for(i=0;i<num;i++)//遍历寻址
//     {
//         if(pr->same_down!=NULL)
//         {
//             pr=pr->same_down;
//         }
//     }

//     if(pr->son!=NULL)//是否存在子节点
//     {
//         pr=pr->son;
//     }
//     else
//     {
//         menu_t *p=NULL;
//         p=(menu_t *)malloc(sizeof(menu_t)); //创建空节点

//         pr->son=p;
//         p->father=pr;
//         p->id=0;
//         p->same_up=NULL;
//         p->same_down=NULL;
//         p->son=NULL;
//         p->function=function;
//         p->function_id=function_id;
//         p->menu_name=name;
//         return p;//返回新创建的子节点
//     }
//     return pr;//返回已存在的子节点
// }

// /**
//  * @description: 菜单结构建立
//  * 
//  * @param: head 头节点 往下创建选项
//  */
// void menu_make(menu_t *head)
// {
//     menu_t *first_page=NULL;
//     init_mempool(first_page,5*sizeof(menu_t));
//     first_page=(menu_t *)malloc(sizeof(menu_t));

//     head=add_same_node(head,menu0,0,"页0");
//     add_son_node(head,0,menu1,1,"页1选项1");
//     add_same_node(first_page,menu2,2,"页1选项2");
//     add_same_node(first_page,menu3,3,"页1选项3");
//     add_same_node(first_page,menu4,4,"页1选项4");
// }
